aW1wb3J0IFJlYWN0LCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZVJlZHVjZXIsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnCmltcG9ydCB7IFByb2plY3RTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvcHJvamVjdFNlcnZpY2UnCmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuL0F1dGhDb250ZXh0JwoKLy8g7ZSE66Gc7KCd7Yq4IO2DgOyehSDsoJXsnZggKOyLpOygnCBTdXBhYmFzZSDsiqTtgqTrp4jsl5Ag66ee7LawIOyImOyglSkKaW50ZXJmYWNlIFByb2plY3QgewogIGlkOiBzdHJpbmcKICBuYW1lOiBzdHJpbmcKICBkZXNjcmlwdGlvbj86IHN0cmluZyB8IG51bGwKICBzdGF0dXM6IHN0cmluZwogIG93bmVyX2lkOiBzdHJpbmcKICBjcmVhdGVkX2F0OiBzdHJpbmcgfCBudWxsCiAgdXBkYXRlZF9hdDogc3RyaW5nIHwgbnVsbAogIFtrZXk6IHN0cmluZ106IGFueSAvLyDstpTqsIAg7ZWE65Oc65Ok7J2EIOychO2VnCDsnbjrjbHsiqQg7Iuc6re464uI7LKYCn0KCmludGVyZmFjZSBQcm9qZWN0SW5zZXJ0IHsKICBuYW1lOiBzdHJpbmcKICBkZXNjcmlwdGlvbj86IHN0cmluZwogIHN0YXR1cz86IHN0cmluZwogIG93bmVyX2lkOiBzdHJpbmcKfQoKaW50ZXJmYWNlIFByb2plY3RVcGRhdGUgewogIG5hbWU/OiBzdHJpbmcKICBkZXNjcmlwdGlvbj86IHN0cmluZwogIHN0YXR1cz86IHN0cmluZwogIHVwZGF0ZWRfYXQ/OiBzdHJpbmcKfQoKLy8g7ZSE66Gc7KCd7Yq4IOyDge2DnCDtg4DsnoUg7KCV7J2YCmludGVyZmFjZSBQcm9qZWN0U3RhdGUgewogIGN1cnJlbnRQcm9qZWN0OiBQcm9qZWN0IHwgbnVsbAogIHVzZXJQcm9qZWN0czogUHJvamVjdFtdCiAgcmVjZW50UHJvamVjdHM6IFByb2plY3RbXQogIGxvYWRpbmc6IGJvb2xlYW4KICBlcnJvcjogc3RyaW5nIHwgbnVsbAp9CgovLyDslaHshZgg7YOA7J6FIOygleydmAp0eXBlIFByb2plY3RBY3Rpb24gPQogIHwgeyB0eXBlOiAnU0VUX0xPQURJTkcnOyBwYXlsb2FkOiBib29sZWFuIH0KICB8IHsgdHlwZTogJ1NFVF9FUlJPUic7IHBheWxvYWQ6IHN0cmluZyB8IG51bGwgfQogIHwgeyB0eXBlOiAnU0VUX0NVUlJFTlRfUFJPSkVDVCc7IHBheWxvYWQ6IFByb2plY3QgfCBudWxsIH0KICB8IHsgdHlwZTogJ1NFVF9VU0VSX1BST0pFQ1RTJzsgcGF5bG9hZDogUHJvamVjdFtdIH0KICB8IHsgdHlwZTogJ1NFVF9SRUNFTlRfUFJPSkVDVFMnOyBwYXlsb2FkOiBQcm9qZWN0W10gfQogIHwgeyB0eXBlOiAnQUREX1BST0pFQ1QnOyBwYXlsb2FkOiBQcm9qZWN0IH0KICB8IHsgdHlwZTogJ1VQREFURV9QUk9KRUNUJzsgcGF5bG9hZDogUHJvamVjdCB9CiAgfCB7IHR5cGU6ICdSRU1PVkVfUFJPSkVDVCc7IHBheWxvYWQ6IHN0cmluZyB9CiAgfCB7IHR5cGU6ICdDTEVBUl9QUk9KRUNUUycgfQoKLy8g7LSI6riwIOyDge2DnApjb25zdCBpbml0aWFsU3RhdGU6IFByb2plY3RTdGF0ZSA9IHsKICBjdXJyZW50UHJvamVjdDogbnVsbCwKICB1c2VyUHJvamVjdHM6IFtdLAogIHJlY2VudFByb2plY3RzOiBbXSwKICBsb2FkaW5nOiBmYWxzZSwKICBlcnJvcjogbnVsbAp9CgovLyDrpqzrk4DshJwKZnVuY3Rpb24gcHJvamVjdFJlZHVjZXIoc3RhdGU6IFByb2plY3RTdGF0ZSwgYWN0aW9uOiBQcm9qZWN0QWN0aW9uKTogUHJvamVjdFN0YXRlIHsKICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7CiAgICBjYXNlICdTRVRfTE9BRElORyc6CiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBsb2FkaW5nOiBhY3Rpb24ucGF5bG9hZCB9CiAgICBjYXNlICdTRVRfRVJST1InOgogICAgICByZXR1cm4geyAuLi5zdGF0ZSwgZXJyb3I6IGFjdGlvbi5wYXlsb2FkLCBsb2FkaW5nOiBmYWxzZSB9CiAgICBjYXNlICdTRVRfQ1VSUkVOVF9QUk9KRUNUJzoKICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIGN1cnJlbnRQcm9qZWN0OiBhY3Rpb24ucGF5bG9hZCB9CiAgICBjYXNlICdTRVRfVVNFUl9QUk9KRUNUUyc6CiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCB1c2VyUHJvamVjdHM6IGFjdGlvbi5wYXlsb2FkLCBsb2FkaW5nOiBmYWxzZSB9CiAgICBjYXNlICdTRVRfUkVDRU5UX1BST0pFQ1RTJzoKICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHJlY2VudFByb2plY3RzOiBhY3Rpb24ucGF5bG9hZCB9CiAgICBjYXNlICdBRERfUFJPSkVDVCc6CiAgICAgIHJldHVybiB7CiAgICAgICAgLi4uc3RhdGUsCiAgICAgICAgdXNlclByb2plY3RzOiBbYWN0aW9uLnBheWxvYWQsIC4uLnN0YXRlLnVzZXJQcm9qZWN0c10sCiAgICAgICAgcmVjZW50UHJvamVjdHM6IFthY3Rpb24ucGF5bG9hZCwgLi4uc3RhdGUucmVjZW50UHJvamVjdHMuc2xpY2UoMCwgNCldCiAgICAgIH0KICAgIGNhc2UgJ1VQREFURV9QUk9KRUNUJzoKICAgICAgcmV0dXJuIHsKICAgICAgICAuLi5zdGF0ZSwKICAgICAgICB1c2VyUHJvamVjdHM6IHN0YXRlLnVzZXJQcm9qZWN0cy5tYXAocCA9PgogICAgICAgICAgcC5pZCA9PT0gYWN0aW9uLnBheWxvYWQuaWQgPyBhY3Rpb24ucGF5bG9hZCA6IHAKICAgICAgICApLAogICAgICAgIHJlY2VudFByb2plY3RzOiBzdGF0ZS5yZWNlbnRQcm9qZWN0cy5tYXAocCA9PgogICAgICAgICAgcC5pZCA9PT0gYWN0aW9uLnBheWxvYWQuaWQgPyBhY3Rpb24ucGF5bG9hZCA6IHAKICAgICAgICApLAogICAgICAgIGN1cnJlbnRQcm9qZWN0OiBzdGF0ZS5jdXJyZW50UHJvamVjdD8uaWQgPT09IGFjdGlvbi5wYXlsb2FkLmlkCiAgICAgICAgICA/IGFjdGlvbi5wYXlsb2FkCiAgICAgICAgICA6IHN0YXRlLmN1cnJlbnRQcm9qZWN0CiAgICAgIH0KICAgIGNhc2UgJ1JFTU9WRV9QUk9KRUNUJzoKICAgICAgcmV0dXJuIHsKICAgICAgICAuLi5zdGF0ZSwKICAgICAgICB1c2VyUHJvamVjdHM6IHN0YXRlLnVzZXJQcm9qZWN0cy5maWx0ZXIocCA9PiBwLmlkICE9PSBhY3Rpb24ucGF5bG9hZCksCiAgICAgICAgcmVjZW50UHJvamVjdHM6IHN0YXRlLnJlY2VudFByb2plY3RzLmZpbHRlcihwID0+IHAuaWQgIT09IGFjdGlvbi5wYXlsb2FkKSwKICAgICAgICBjdXJyZW50UHJvamVjdDogc3RhdGUuY3VycmVudFByb2plY3Q/LmlkID09PSBhY3Rpb24ucGF5bG9hZAogICAgICAgICAgPyBudWxsCiAgICAgICAgICA6IHN0YXRlLmN1cnJlbnRQcm9qZWN0CiAgICAgIH0KICAgIGNhc2UgJ0NMRUFSX1BST0pFQ1RTJzoKICAgICAgcmV0dXJuIHsKICAgICAgICAuLi5zdGF0ZSwKICAgICAgICBjdXJyZW50UHJvamVjdDogbnVsbCwKICAgICAgICB1c2VyUHJvamVjdHM6IFtdLAogICAgICAgIHJlY2VudFByb2plY3RzOiBbXSwKICAgICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgICBlcnJvcjogbnVsbAogICAgICB9CiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gc3RhdGUKICB9Cn0KCi8vIOy7qO2FjeyKpO2KuCDtg4DsnoUg7KCV7J2YCmludGVyZmFjZSBQcm9qZWN0Q29udGV4dFR5cGUgewogIHN0YXRlOiBQcm9qZWN0U3RhdGUKICBzZWxlY3RQcm9qZWN0OiAocHJvamVjdDogUHJvamVjdCkgPT4gdm9pZAogIGxvYWRVc2VyUHJvamVjdHM6IChvcHRpb25zPzogeyBzaWxlbnQ/OiBib29sZWFuIH0pID0+IFByb21pc2U8dm9pZD4KICBsb2FkUmVjZW50UHJvamVjdHM6ICgpID0+IFByb21pc2U8dm9pZD4KICBjcmVhdGVQcm9qZWN0OiAocHJvamVjdERhdGE6IFByb2plY3RJbnNlcnQpID0+IFByb21pc2U8UHJvamVjdD4KICB1cGRhdGVQcm9qZWN0OiAocHJvamVjdElkOiBzdHJpbmcsIHVwZGF0ZXM6IFByb2plY3RVcGRhdGUpID0+IFByb21pc2U8UHJvamVjdD4KICBkZWxldGVQcm9qZWN0OiAocHJvamVjdElkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4KICBnZXRDdXJyZW50UHJvamVjdDogKCkgPT4gUHJvamVjdCB8IG51bGwKICBjbGVhclByb2plY3RzOiAoKSA9PiB2b2lkCn0KCi8vIOyViOydhCDsg4Htg5zquLAKY29uc3QgUHJvamVjdENvbnRleHQgPSBjcmVhdGVDb250ZXh0PFByb2plY3RDb250ZXh0VHlwZSB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKQoKLy8g7Z6I64ukIOygleyImO2PmApleHBvcnQgZnVuY3Rpb24gUHJvamVjdFByb3ZpZGVyKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pIHsKICBjb25zdCBbc3RhdGUsIGRpc3BhdGNoXSA9IHVzZVJlZHVjZXIocHJvamVjdFJlZHVjZXIsIGluaXRpYWxTdGF0ZSkKICBjb25zdCB7IHVzZXIsIGlzQXV0aGVudGljYXRlZCB9ID0gdXNlQXV0aCgpCiAgY29uc3QgbGFzdExvYWRlZFVzZXJJZFJlZiA9IHVzZVJlZjxzdHJpbmcgfCBudWxsPihudWxsKQogIGNvbnN0IHVzZXJJZCA9IHVzZXI/LmlkID8/IG51bGwKCiAgLy8g7J6F7KeA66GcIOqwgOyguOyYpAogIGNvbnN0IGxvYWRVc2VyUHJvamVjdHMgPSBhc3luYyAob3B0aW9ucz86IHsgc2lsZW50PzogYm9vbGVhbiB9KSA9PiB7CiAgICBpZiAoIXVzZXIpIHJldHVybgogCiAgICBjb25zdCBoYXNQcm9qZWN0cyA9IHN0YXRlLnVzZXJQcm9qZWN0cy5sZW5ndGggPiAwCiAgICBjb25zdCBzaG91bGRTaG93TG9hZGluZyA9ICEob3B0aW9ucz8uc2lsZW50ICYmIGhhc1Byb2plY3RzKQogCiAgICB0cnkgewogICAgICBpZiAoc2hvdWxkU2hvd0xvYWRpbmcpIHsKICAgICAgICBkaXNwYXRjaCh7IHR5cGU6ICdTRVRfTE9BRElORycsIHBheWxvYWQ6IHRydWUgfSkKICAgICAgfQogICAgICBkaXNwYXRjaCh7IHR5cGU6ICdTRVRfRVJST1InLCBwYXlsb2FkOiBudWxsIH0pCiAgCiAgICAgIGNvbnN0IHByb2plY3RzID0gYXdhaXQgUHJvamVjdFNlcnZpY2UuZ2V0VXNlclByb2plY3RzKHVzZXIuaWQpCiAgICAgIGRpc3BhdGNoKHsgdHlwZTogJ1NFVF9VU0VSX1BST0pFQ1RTJywgcGF5bG9hZDogcHJvamVjdHMgfSkKCiAgICAgIC8vIOyEnOuwmCDsmKTrk5wg7Yq47LmYIOyViOydhCDtlZjsooXrk6Ag7Jio64qUIAogICAgICBpZiAoIXN0YXRlLmN1cnJlbnRQcm9qZWN0ICYmIHByb2plY3RzLmxlbmd0aCA+IDApIHsKICAgICAgICBkaXNwYXRjaCh7IHR5cGU6ICdTRVRfQ1VSUkVOVF9QUk9KRUNUJywgcGF5bG9hZDogcHJvamVjdHNbMF0gfSkKICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgdXNlciBwcm9qZWN0czonLCBlcnJvcikKICAgICAgZGlzcGF0Y2goeyB0eXBlOiAnU0VUX0VSUk9SJywgcGF5bG9hZDogJ+qwgOusuO yng==